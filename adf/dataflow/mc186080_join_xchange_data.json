{
	"name": "mc186080_join_xchange_data",
	"properties": {
		"type": "MappingDataFlow",
		"typeProperties": {
			"sources": [
				{
					"dataset": {
						"referenceName": "get_xchange_rate_json_ds",
						"type": "DatasetReference"
					},
					"name": "getXchangeJson"
				}
			],
			"sinks": [
				{
					"dataset": {
						"referenceName": "DelimitedText1",
						"type": "DatasetReference"
					},
					"name": "sink1"
				}
			],
			"transformations": [
				{
					"name": "Flatten1"
				}
			],
			"script": "source(output(\n\t\tbase as string,\n\t\trates as (GBP as double, HKD as double, IDR as double, ILS as double, DKK as double, INR as double, CHF as double, MXN as double, CZK as double, SGD as double, THB as double, HRK as double, EUR as double, MYR as double, NOK as double, CNY as double, BGN as double, PHP as double, PLN as double, ZAR as double, CAD as double, ISK as double, BRL as double, RON as double, NZD as double, TRY as double, JPY as double, RUB as double, KRW as double, USD as double, AUD as double, HUF as double, SEK as double),\n\t\tdate as string\n\t),\n\tallowSchemaDrift: false,\n\tvalidateSchema: false,\n\tignoreNoFilesFound: false) ~> getXchangeJson\ngetXchangeJson foldDown(unroll(rates),\n\tmapColumn(\n\t\tbase,\n\t\tdate,\n\t\tref = rates.ref,\n\t\tval = rates.val\n\t),\n\tskipDuplicateMapInputs: false,\n\tskipDuplicateMapOutputs: false) ~> Flatten1\nFlatten1 sink(input(\n\t\t{Flight#} as string,\n\t\tOrigin as string,\n\t\tDest as string,\n\t\tFlightDate as string,\n\t\tNoSalesReason as string,\n\t\tTransmittingFlightAttd as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> sink1"
		}
	}
}